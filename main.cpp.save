
    #include "TXLib.h"

struct Picture

 {
    int x;
    int y;
    HDC image;
    int vx;
    int vy;

 };

struct Barriar
 {
     int x;
     int y;
     int w;
     int h;

 };

struct Bullet
{
    int x;
    int y;
    bool visible;
    int vx;
    int vy;

    void draw()
    {
        txSetColor (TX_BLACK);
        txSetFillColor (TX_BLACK);
        txCircle(x,y,5);
    }
};

void draw_picture (Picture picture)
{
    txTransparentBlt (txDC(), picture.x,  picture.y,  95,213, picture.image, 0, 0, TX_WHITE);
}

int main()
{
txCreateWindow(800,600);
txDisableAutoPause();

    HDC background = txLoadImage ("fon.bmp");
    int x_background = 0;
    int y_background = 0;

    // 1 упр
    Picture picture1 = {300, 300, txLoadImage ("man.bmp"), 5, 5};

    // 2 вверх вниз
    Picture picture2 = {400, 300, picture1.image, 15, 5};

    //Barriar
    Barriar bar1 = {600, 100, 100, 400};
                  
    Bullet bul = {150, 150, true, 0, 10};

    char str [10];
    const char* str1 = "1";


    while(!GetAsyncKeyState(VK_ESCAPE))
    {
        txClear();
        txSetColor(TX_WHITE,5);
        txSetFillColor(TX_BLACK);

        txBitBlt (txDC(), x_background,   y_background,  800, 600, background);

        draw_picture(picture1);
        draw_picture(picture2);

        txRectangle(bar1.x, bar1.y, bar1.x+bar1.w, bar1.y+bar1.h);

        picture2.y = picture2.y + picture2.vy;
        picture2.x = picture2.x + picture2.vx;

        if (picture1.x < bar1.x+bar1.w && picture1.x+213 > bar1.x)
        {
            picture1.x = bar1.x;
        }


        if(picture2.y<0 || picture2.y>600)
        {
            picture2.vy=-picture2.vy;
        }

        if(picture2.x<0 || picture2.x>800)
        {
            picture2.vx=-picture2.vx;
        }

        if(bul.visible)
        {
            bul.draw();
        }

        if(GetAsyncKeyState (VK_SPACE))
        {
            bul.visible = true;
            bul.x = picture1.x;
            bul.y = picture1.y;
        }

        if(GetAsyncKeyState ('W'))
        {
            picture1.y = picture1.y - picture1.vy;
        }

        if(GetAsyncKeyState ('S'))
        {
            picture1.y = picture1.y + picture1.vy;
        }

        if(GetAsyncKeyState ('A'))
        {
            picture1.x = picture1.x - picture1.vx;
        }

        if(GetAsyncKeyState ('D'))
        {
            txSetColor(TX_WHITE);
            picture1.x = picture1.x + picture1.vx;
        }

        sprintf(str,"Кордина x = %d", picture1.x);
        txTextOut(10, 10, str);


        txTextOut(10, 30, str1);

        if(GetAsyncKeyState ('Y'))
        {
           str1 = "Y";
        }





        if(picture1.x < 0)
        {
            picture1.x = 0;
            x_background += 5;
        }

        if(picture1.x > 800-95)
        {
            picture1.x = 800-95;
            x_background -= 5;
        }

        if(picture1.y < 0)
        {
            picture1.y = 0;
            y_background +=5;
        }

        if(picture1.y > 600-213)
        {
            picture1.y = 600-213;
            y_background -= 5;
        }



        txSleep(10);
    }

    txDeleteDC (background);
    txDeleteDC (picture1.image);
    txDeleteDC (picture2.image);

txTextCursor (false);
return 0;
}


